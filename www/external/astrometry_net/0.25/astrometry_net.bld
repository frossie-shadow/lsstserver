# LSST build script for boost 
#
# This should work on Linux, Linux64, and DarwinX86
#
tarfile=astrometry.net-0.25.tar.gz

fetch external/astrometry_net/$version/$tarfile
unpack_tar_and_enter $tarfile

make 
INSTALL_DIR=$installdir make install

echo Installing include files
for d in blind util libkd qfits-an qfits-an/src; do 
    echo mkdir -p $installdir/include/$d >> $buildlog
    mkdir -p $installdir/include/$d >> $buildlog 2>&1
    echo cp $d/*.h $installdir/include >> $buildlog
    cp $d/*.h $installdir/include >> $buildlog 2>&1
    if { ls $d/*.inc > /dev/null 2>&1; }; then
       echo cp $d/*.inc $installdir/include >> $buildlog
       cp $d/*.inc $installdir/include >> $buildlog 2>&1
    fi
done

echo Installing libraries
echo mkdir -p $installdir/lib >> $buildlog
mkdir -p $installdir/lib >> $buildlog 2>&1
for l in blind/libbackend.so; do
    echo cp $l $installdir/lib >> $buildlog
    cp $l $installdir/lib >> $buildlog 2>&1
done
